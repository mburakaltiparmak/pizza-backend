# ============================================================================
# APPLICATION-DEV.PROPERTIES - DEVELOPMENT ENVIRONMENT
# ============================================================================
# DATABASE CONFIGURATION - DEV SCHEMA (FIXED)
# ============================================================================
spring.datasource.url=${DATABASE_URL:jdbc:postgresql://localhost:5432/postgres?currentSchema=pizza}
spring.datasource.username=${DATABASE_USERNAME:postgres}
spring.datasource.password=${DATABASE_PASSWORD:password}
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA/Hibernate Configuration (CRITICAL FIXES)
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.default_schema=pizza
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true

# SQL Initialization (DISABLED - using dev-schema-init.sql manually)
spring.sql.init.mode=always
spring.jpa.defer-datasource-initialization=false

# Connection Pool (HikariCP)
spring.datasource.hikari.pool-name=PizzaDevHikariPool
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# ============================================================================
# REDIS CONFIGURATION - DEV
# ============================================================================
spring.data.redis.host=${REDIS_HOST:localhost}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.password=${REDIS_PASSWORD:}
spring.data.redis.timeout=60000
spring.data.redis.database=1

# Redis Cache Configuration
spring.cache.type=redis
spring.cache.redis.time-to-live=3600000
spring.cache.redis.cache-null-values=false
spring.cache.redis.use-key-prefix=true
spring.cache.redis.key-prefix=dev:

# ============================================================================
# ELASTICSEARCH CONFIGURATION - DEV (Phase 5.1: NEW)
# ============================================================================
# Connection Settings
spring.elasticsearch.uris=${ELASTICSEARCH_SCHEME:http}://${ELASTICSEARCH_HOST:localhost}:${ELASTICSEARCH_PORT:9200}
spring.elasticsearch.connection-timeout=10s
spring.elasticsearch.socket-timeout=30s

# Index Settings
elasticsearch.index.products=products
elasticsearch.index.orders=orders
elasticsearch.index.number-of-shards=1
elasticsearch.index.number-of-replicas=0

# Sync Settings
elasticsearch.sync.enabled=true
elasticsearch.sync.batch-size=100
elasticsearch.sync.schedule.enabled=true
elasticsearch.sync.schedule.cron=0 0 3 * * ?

# Search Settings
elasticsearch.search.max-results=100
elasticsearch.search.fuzziness=AUTO
elasticsearch.search.min-score=0.5

# Feature Flags
elasticsearch.features.search-enabled=true
elasticsearch.features.analytics-enabled=true
elasticsearch.features.suggestions-enabled=true

# ============================================================================
# SUPABASE CONFIGURATION - DEV (DISABLED)
# ============================================================================
app.supabase.url=${SUPABASE_URL:http://localhost:8080}
app.supabase.anon-key=${SUPABASE_KEY:dummy-key-for-dev}
app.supabase.jwt.secret=${SUPABASE_JWT_SECRET:dummy-jwt-secret-for-dev}
app.supabase.enabled=false

# ============================================================================
# JWT CONFIGURATION - DEV (Phase 4.4: Access & Refresh Token Separation)
# ============================================================================
jwt.secret=${JWT_SECRET:dev-secret-key-for-testing-purposes-only-change-in-production}

# LEGACY: Kept for backward compatibility (deprecated methods use this)
jwt.expiration=86400000

# PHASE 4.4 NEW: Access Token (short-lived for API authentication)
# Duration: 30 minutes = 1800000ms
# Used by: UnifiedTokenProvider.generateAccessToken()
jwt.access-token.expiration=1800000

# PHASE 4.4 NEW: Refresh Token (long-lived, stored in database via RefreshTokenService)
# Duration: 7 days = 604800000ms
# Used by: RefreshTokenServiceImpl
jwt.refresh-token.expiration=604800000

# ============================================================================
# CLOUDINARY CONFIGURATION - DEV
# ============================================================================
cloudinary.cloud-name=${CLOUD_NAME}
cloudinary.api-key=${API_KEY}
cloudinary.api-secret=${API_SECRET}

# ============================================================================
# EMAIL CONFIGURATION - DEV (Console output)
# ============================================================================
spring.mail.host=${MAIL_HOST}
spring.mail.port=${MAIL_PORT}
spring.mail.username=${MAIL_USERNAME}
spring.mail.password=${MAIL_PASSWORD}
spring.mail.properties.mail.smtp.ssl.enable=${MAIL_SMTP_SSL_ENABLE:true}
spring.mail.properties.mail.smtp.ssl.required=${MAIL_SMTP_SSL_REQUIRED:true}
spring.mail.properties.mail.smtp.starttls.enable=${MAIL_SMTP_STARTTLS_ENABLE:false}
spring.mail.properties.mail.smtp.starttls.required=${MAIL_SMTP_STARTTLS_REQUIRED:false}
spring.mail.properties.mail.smtp.from=${MAIL_FROM_ADDRESS}
spring.mail.from-address=${MAIL_FROM_ADDRESS}

# Email Async Configuration
spring.mail.properties.mail.smtp.connectiontimeout=5000
spring.mail.properties.mail.smtp.timeout=5000
spring.mail.properties.mail.smtp.writetimeout=5000

# ============================================================================
# CORS CONFIGURATION - DEV (Permissive)
# ============================================================================
spring.mvc.cors.allowed-origins=http://localhost:3000,http://localhost:5173,http://127.0.0.1:3000
spring.mvc.cors.max-age=3600

# ============================================================================
# LOGGING CONFIGURATION - DEV (Detailed + Elasticsearch)
# ============================================================================
logging.level.root=INFO
logging.level.com.example.pizza=DEBUG
logging.level.org.springframework.web=DEBUG
logging.level.org.springframework.security=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# Elasticsearch Logging (Phase 5.1: NEW)
logging.level.org.springframework.data.elasticsearch=DEBUG
logging.level.org.elasticsearch.client=DEBUG
logging.level.tracer=TRACE

# Log pattern
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# ============================================================================
# ACTUATOR CONFIGURATION - DEV (All endpoints enabled + ES health)
# ============================================================================
management.endpoints.web.exposure.include=*
management.endpoint.health.show-details=always
management.endpoint.metrics.enabled=true
management.endpoint.prometheus.enabled=true
management.health.elasticsearch.enabled=true

# Health Check Configuration
# Accept YELLOW status for single-node development (replicas cannot be allocated)
management.health.defaults.enabled=true
management.health.mail.enabled=false
management.endpoint.health.group.readiness.include=*
management.endpoint.health.group.readiness.show-details=always

# ============================================================================
# MULTIPART FILE UPLOAD - DEV
# ============================================================================
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB
spring.servlet.multipart.enabled=true

# ============================================================================
# ASYNC CONFIGURATION - DEV
# ============================================================================
spring.task.execution.pool.core-size=5
spring.task.execution.pool.max-size=10
spring.task.execution.pool.queue-capacity=25
spring.task.execution.thread-name-prefix=dev-async-

# ============================================================================
# SERVER CONFIGURATION - DEV
# ============================================================================
server.port=8080
server.address=0.0.0.0
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-stacktrace=always
server.error.include-exception=true

# ============================================================================
# DEVELOPMENT MODE FLAGS
# ============================================================================
# Dev mode indicator
app.environment=development
app.dev-mode=true
app.database.schema=pizza
app.using-test-data=true

# Debug Features
spring.devtools.restart.enabled=true
spring.devtools.livereload.enabled=true

app.base-url=${APP_BASE_URL:http://localhost:3000}
app.oauth2.redirect-uri=${OAUTH2_REDIRECT_URI:http://localhost:3000/oauth2/callback}

# ============================================================================
# RATE LIMITING - DEV (Relaxed)
# ============================================================================
bucket4j.enabled=true
bucket4j.filters[0].cache-name=rate-limit-buckets-dev
bucket4j.filters[0].url=.*
bucket4j.filters[0].rate-limits[0].bandwidths[0].capacity=1000
bucket4j.filters[0].rate-limits[0].bandwidths[0].time=1
bucket4j.filters[0].rate-limits[0].bandwidths[0].unit=minutes

# ============================================================================
# DATABASE INITIALIZER - CONDITIONAL (DEV ONLY)
# ============================================================================
app.database.init.enabled=false